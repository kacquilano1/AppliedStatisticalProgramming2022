---
title: "Applied Statistical Programming - Spring 2022"
Author: "Kimberly Acquilano"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\begin{center}
{\Large{\textbf{Problem Set 3}}} \\
\vspace{4 bp}
Due Wednesday, March 2, 10:00 AM (Before Class) \\
\end{center}

\section*{Instructions}
\begin{enumerate}
  \item The following questions should each be answered within an R script. Be sure to provide many comments in the script to facilitate grading. Undocumented code will not be graded.
  \item Work on git. Fork the repository found at \url{https://github.com/johnsontr/AppliedStatisticalProgramming2022} and add your code for Problem Set 3, committing and pushing frequently. Use meaningful commit messages because these will affect your grade.
  \item You may work in teams, but each student should develop their own Rmarkdown file. To be clear, there should be no copy and paste. Each keystroke in the assignment should be your own.
  \item For students new to programming, this may take a while. Get started.
\end{enumerate}

\section*{Let's Make a Deal\footnote{\url{https://en.wikipedia.org/wiki/Let's_Make_a_Deal}}}
In the game show "Let's Make a Deal'', the candidate gets to choose one of three closed doors, and receives the prize behind the door they choose. Behind one door is a new car; behind the other two doors are goats. After the contestant selects one of the 3 doors, the host opens one of the other two doors, and reveals a goat. Now, the candidate has the option of either sticking with the door they originally selected, or switching to the only other door that is still closed. What should the candidate do, and why? What are the probabilities of winning the car if they stay versus if they switch? This question is known as the Monty Hall Problem.


\subsection*{Your tasks}
For this problem set, you will not solve the Monty Hall Problem, but you will have to code a slightly simplified version of the "Let's Make a Deal" game. More specifically, you will set up a new class, which contains information regarding the door a player chooses, and a method that simulates a modified version of the game. You will have to do this using the S3 class system. Here are the specific instructions:

\begin{enumerate}
  \item Define a new class: \texttt{door}. Objects of this class simply take on one numeric value: 1, 2, or 3 -- indicating which door a candidate chooses.
  
```{r}
#Create a new object called Door
#Door has value of 1, 2, or 3, indicating the door chosen
#The options are listed here. Player can see these option and choose which Door to 'open', by deleting the comment symbol of the chosen Door and making sure the others are commented-out.
#For now, I will choose Door 1 (leaving it un-commented)
Door <- 1
#Door <- 2
#Door <- 3

#create class "door" and assign it to the object Door
class(Door) <- "door"

#Test object Door for correct value and class
Door
str(Door)


```

  
  \item Create a method for \texttt{door} objects that is called \texttt{PlayGame}. This method is supposed to do the following:
\begin{itemize}
  \item take the numeric value that is stored in the \texttt{door} object,
  \item draw a random number between 1 and 3 that presents the door behind which the car is hidden,
  \item compare the two numbers, and print a message congratulating a winning candidate that chose the correct door, or expressing sympathies for a losing candidate that chose the wrong door.
\end{itemize}
  \item Write: 
  \begin{itemize}
    \item a construction function that allows the user to create a \texttt{door} object,
    \item and a validation function that checks whether the value stored in \texttt{door} is actually an integer
  \end{itemize}
\end{enumerate}

```{r tidy=TRUE}

#Create a new method called PlayGame
PlayGame <- function(door) {
  UseMethod("PlayGame")
} #end of PlayGame function to create method


#Fashion the method PlayGame for when it is used on door
PlayGame.door <- function(door) {
  #Store the value of door chosen by the contestant, and store it as Chosen
  Chosen <- door
  
  #Draw a random number, 1-3, to indicate where the prize is.
  #Call this random number Prize
  Prize <- sample(c(1, 2, 3), 1)
  
  #Create an if statement
  #If the values for Chosen and Prize are the same, print a "congratulations" message.
  if (Chosen == Prize) {
    print("Congratulations! You've won yourself a new car!!")
  } #end of "if" statement
  
  #If the values for Chosen and Prize are not the same, print a "sympathies" message.
  else if (Chosen != Prize) {
    print("We're sorry. You did not win this time. Please try again!")
  }#end of "else" if statement
  
} #end of PlayGame function

#Test object door
Door
#door is value of 1
#Test PlayGame method with door. If the random prize is 1, it will print congrats message. If it is 2 or 3, it will print sorry message.
PlayGame(Door[1])


#Door Function 1##
######This function creates door and turns input into an integer####
######
######
#Now create a function that allows the user to create a door object, anad will turn the input into an integer
door <- function(x) {
  #Make sure that the input is an numeric If it is not, throw an error
  if (!(is.numeric(x))) {stop("Error: x is not a numeric")}
  
  #Make sure that the input is of value 1, 2, or 3. If it is not, throw an error.
  #To do this create a vector of values 1, 2, and 3, CorrectValue
  CorrectValue <- c(1, 2, 3)
  
  #Compare the input to the CorrectValue object
  #If the input is contained in CorrectValue (meaning, it is  the number 1, 2, or 3), then turn the input into an integer
  if ((x %in% CorrectValue)) {
    x <- as.integer(x)
  } #end of "if" statement
  #If the input is not contained in CorrectValue, then throw an error message
    else {
    stop("Error: x does not have a value of 1, 2, or 3")
  } #end of "else" statement
  
  #Assign class of "door" to the input
  class(x) <- "door"
  
  return(x)
} #end of door function


#Test this function with the y "door" created above
YDoor <- door(y)
YDoor

#Test this function with a new object that does not conform
#Create an object a, with the value of 2.5
a <- 2.5
#Create an object, (Contest's guess), with the door function
DoorA <- door(a)
#Cannot do this, throws an error


##Door Function 2##
#####This input just creates door with a numeric and does not change its type
######
######
##Now create a function that allows the user to create a door object
door <- function(x) {
  #Make sure that the input is a numeric. If it is not, throw an error
  if (!(is.numeric(x))) {stop("Error: x is not a numeric")}
  
  #Make sure that the input is of value 1, 2, or 3. If it is not, throw an error.
  #To do this create a vector of values 1, 2, and 3, CorrectValue
  CorrectValue <- c(1, 2, 3)
  
  #Compare the input to the CorrectValue object
  #If the input is not contained in CorrectValue (meaning, it is not the number 1, 2, or 3), then throw an error message
  if (!(x %in% CorrectValue)) {
    stop("Error: x does not have a value of 1, 2, or 3")
  }
  
  #Assign class of "door" to the input
  class(x) <- "door"
  
  return(x)
} #end of door function


#Test the function with different values
x <- "a"
door(x)
door(12)
door(1)
door(2)
d <- door(3)

door(2.5)
d


#Create a validator function, which will verify that the object is an integer
validate_door_integer <- function(x){
  #if the type input is not an integer throw error message
  if(!(is.integer(x))) {
    stop("Object is not an integer")
  } 
  
  #if it is an integer print an affirmation message
  else { print("Yes, this is an integer")
  }
} #end of validator function

#Test validator with YDoor
validate_door_integer(YDoor)



#Create a validator function, which will verify that the object is of class "door"
validate_door <- function(x){
  #if the class is not "door" throw error message
  if(class(x) != "door") {
    stop("Object is not of class door")
  } 
  
  #if the class is "door" print an affirmation message
  else { print("Yes, this is a door")
  }
} #end of validator function

#Test validator with YDoor
validate_door(YDoor)


#Test the door function with the PlayGame method
#Test PlayGame method on the YDoor object created
PlayGame(YDoor)

```
